"use strict";(globalThis.webpackChunk_stlite_desktop=globalThis.webpackChunk_stlite_desktop||[]).push([[6683],{86683:(e,t,s)=>{s.r(t),s.d(t,{default:()=>v});var i=s(5057),o=s(9187),a=s.n(o),r=s(31476),n=s(80865),l=s(9191),d=s(73830),p=s(98209),m=s(18950),h=s(4337),u=s(89401),g=s(46434),c=s(96266);const f="YYYY/MM/DD";function b(e){return e.map((e=>new Date(e)))}class y extends i.PureComponent{constructor(...e){super(...e),this.formClearHelper=new p.Kz,this.state={values:this.initialValue,isRange:this.props.element.isRange,isEmpty:!1},this.commitWidgetValue=e=>{this.props.widgetMgr.setStringArrayValue(this.props.element,this.state.values.map((e=>a()(e).format(f))),e)},this.onFormCleared=()=>{const e=b(this.props.element.default);this.setState({values:e},(()=>this.commitWidgetValue({fromUi:!0})))},this.handleChange=({date:e})=>{if(null===e||void 0===e)return void this.setState({values:[],isEmpty:!0});const t=[];Array.isArray(e)?e.forEach((e=>{e&&t.push(e)})):t.push(e),this.setState({values:t,isEmpty:!t},(()=>{this.state.isEmpty||this.commitWidgetValue({fromUi:!0})}))},this.handleClose=()=>{const{isEmpty:e}=this.state;e&&this.setState(((e,t)=>({values:b(t.element.default),isEmpty:!b(t.element.default)})),(()=>{this.commitWidgetValue({fromUi:!0})}))},this.getMaxDate=()=>{const{element:e}=this.props,t=e.max;return t&&t.length>0?a()(t,f).toDate():void 0}}get initialValue(){const e=this.props.widgetMgr.getStringArrayValue(this.props.element);return b(void 0!==e?e:this.props.element.default)}componentDidMount(){this.props.element.setValue?this.updateFromProtobuf():this.commitWidgetValue({fromUi:!1})}componentDidUpdate(){this.maybeUpdateFromProtobuf()}componentWillUnmount(){this.formClearHelper.disconnect()}maybeUpdateFromProtobuf(){const{setValue:e}=this.props.element;e&&this.updateFromProtobuf()}updateFromProtobuf(){const{value:e}=this.props.element;this.props.element.setValue=!1,this.setState({values:e.map((e=>new Date(e)))},(()=>{this.commitWidgetValue({fromUi:!1})}))}render(){var e;const{width:t,element:s,disabled:i,theme:o,widgetMgr:r}=this.props,{values:p,isRange:b}=this.state,{colors:y,fontSizes:v,lineHeights:C}=o,x={width:t},V=a()(s.min,f).toDate(),D=this.getMaxDate();return this.formClearHelper.manageFormClearListener(r,s.formId,this.onFormCleared),(0,c.jsxs)("div",{className:"stDateInput",style:x,children:[(0,c.jsx)(m.ON,{label:s.label,disabled:i,labelVisibility:(0,g.iF)(null===(e=s.labelVisibility)||void 0===e?void 0:e.value),children:s.help&&(0,c.jsx)(m.dT,{children:(0,c.jsx)(h.ZP,{content:s.help,placement:u.ug.TOP_RIGHT})})}),(0,c.jsx)(n.Z,{density:l.pw.high,formatString:"yyyy/MM/dd",disabled:i,onChange:this.handleChange,onClose:this.handleClose,overrides:{Popover:{props:{placement:d.r4.bottomLeft,overrides:{Body:{style:{border:`1px solid ${y.fadedText10}`}}}}},CalendarContainer:{style:{fontSize:v.sm,paddingRight:o.spacing.sm,paddingLeft:o.spacing.sm,paddingBottom:o.spacing.sm,paddingTop:o.spacing.sm}},Week:{style:{fontSize:v.sm}},Day:{style:({$pseudoHighlighted:e,$pseudoSelected:t,$selected:s,$isHovered:i})=>({fontSize:v.sm,lineHeight:C.base,"::before":{backgroundColor:s||t||e||i?`${y.secondaryBg} !important`:y.transparent},"::after":{borderColor:y.transparent}})},PrevButton:{style:()=>({display:"flex",alignItems:"center",justifyContent:"center",":active":{backgroundColor:y.transparent},":focus":{backgroundColor:y.transparent,outline:0}})},NextButton:{style:{display:"flex",alignItems:"center",justifyContent:"center",":active":{backgroundColor:y.transparent},":focus":{backgroundColor:y.transparent,outline:0}}},Input:{props:{maskChar:null,overrides:{Root:{style:{borderLeftWidth:"1px",borderRightWidth:"1px",borderTopWidth:"1px",borderBottomWidth:"1px"}},Input:{style:{paddingRight:".5rem",paddingLeft:".5rem",paddingBottom:".5rem",paddingTop:".5rem"}}}}}},value:p,minDate:V,maxDate:D,range:b})]})}}const v=(0,r.b)(y)}}]);