(globalThis.webpackChunk_stlite_desktop=globalThis.webpackChunk_stlite_desktop||[]).push([[8418],{60039:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>_});var o=i(5057),n=i(97991),s=i(50482),a=i.n(s),r=i(64169),h=i(31476),c=i(23878),l=i(34531),p=i(80552),d=i(58186),m=i(65815),w=i(50256),g=i(98899),u=i(22404),x=i(719),b=i(82601),S=i(51842),k=i(10157),j=i(10458),y=i.n(j),f=i(11787);class v extends Error{}class T extends Error{}class V{static async get(t){const{commandLine:e,userMapboxToken:i}=t.current;return V.token&&V.commandLine===e.toLowerCase()||(V.token=""!==i?i:await this.fetchToken("https://data.streamlit.io/tokens.json","mapbox"),V.commandLine=e.toLowerCase()),V.token}static async fetchToken(t,e){try{const i=await y().get(t),{[e]:o}=i.data;if(null==o||""===o)throw new Error(`Missing token "${e}"`);return o}catch(i){const e=(0,f.b)(i);throw new T(`${e.message} (${t})`)}}}V.token=void 0,V.commandLine=void 0,V.isRunningLocal=()=>{const{hostname:t}=window.location;return"localhost"===t||"127.0.0.1"===t};var C=i(56129),E=i.n(C),M=i(70991),Z=i(96266);const O=({error:t,width:e,deltaType:i})=>t instanceof v?(0,Z.jsx)(M.Z,{width:e,name:"No Mapbox token provided",message:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)("p",{children:["To use ",(0,Z.jsxs)("code",{children:["st.",i]})," or ",(0,Z.jsx)("code",{children:"st.map"})," you need to set up a Mapbox access token."]}),(0,Z.jsxs)("p",{children:["To get a token, create an account at"," ",(0,Z.jsx)("a",{href:"https://mapbox.com",children:"https://mapbox.com"}),". It's free for moderate usage levels!"]}),(0,Z.jsxs)("p",{children:["Once you have a token, just set it using the Streamlit config option ",(0,Z.jsx)("code",{children:"mapbox.token"})," and don't forget to restart your Streamlit server at this point if it's still running, then reload this tab."]}),(0,Z.jsxs)("p",{children:["See"," ",(0,Z.jsx)("a",{href:"https://docs.streamlit.io/library/advanced-features/configuration#view-all-configuration-options",children:"our documentation"})," ","for more info on how to set config options."]})]})}):t instanceof T?(0,Z.jsx)(M.Z,{width:e,name:"Error fetching Streamlit Mapbox token",message:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("p",{children:"This app requires an internet connection."}),(0,Z.jsx)("p",{children:"Please check your connection and try again."}),(0,Z.jsxs)("p",{children:["If you think this is a bug, please file bug report"," ",(0,Z.jsx)("a",{href:"https://github.com/streamlit/streamlit/issues/new/choose",children:"here"}),"."]})]})}):(0,Z.jsx)(M.Z,{width:e,name:"Error fetching Streamlit Mapbox token",message:t.message}),F=t=>e=>{class i extends o.PureComponent{constructor(i){super(i),this.initMapboxToken=async()=>{try{const t=await V.get(this.props.sessionInfo);this.setState({mapboxToken:t,isFetching:!1})}catch(t){const e=(0,f.b)(t);this.setState({mapboxTokenError:e,isFetching:!1})}},this.render=()=>{const{mapboxToken:i,mapboxTokenError:o,isFetching:n}=this.state,{width:s}=this.props;return o?(0,Z.jsx)(O,{width:s,error:o,deltaType:t}):n?(0,Z.jsx)(S.Z,{body:"Loading...",kind:k.h.INFO,width:s}):(0,Z.jsx)(e,{...this.props,mapboxToken:i,width:s})},this.state={isFetching:!0,mapboxToken:void 0,mapboxTokenError:void 0},this.initMapboxToken()}}return i.displayName=`withMapboxToken(${e.displayName||e.name})`,E()(i,e)};var L=i(46434),N=i(45490);const P=(0,N.Z)("div",{target:"e1tsyoib1"})((({width:t,height:e,theme:i})=>({marginTop:i.spacing.sm,position:"relative",height:e,width:t})),""),I=(0,N.Z)("div",{target:"e1tsyoib0"})((({theme:t})=>({position:"absolute",right:"2.625rem",top:t.spacing.md,zIndex:1,"button:not(:disabled)":{background:t.colors.bgColor,"& + button":{borderTopColor:t.colors.secondaryBg},"& span":{filter:(0,c.Iy)(t)?"":"invert(100%)"}}})),"");i(20512);const z={classes:{...l,...m,...d,...w}};(0,x.fh)([g.w,u.E]);const D=new p.Z({configuration:z});class $ extends o.PureComponent{constructor(...t){super(...t),this.state={viewState:{bearing:0,pitch:0,zoom:11},initialized:!1,initialViewState:{}},this.componentDidMount=()=>{this.setState({initialized:!0})},this.createTooltip=t=>{const{element:e}=this.props;if(!t||!t.object||!e.tooltip)return!1;const i=JSON.parse(e.tooltip);return i.html?i.html=this.interpolate(t,i.html):i.text=this.interpolate(t,i.text),i},this.interpolate=(t,e)=>{const i=e.match(/{(.*?)}/g);return i&&i.forEach((i=>{const o=i.substring(1,i.length-1);t.object.hasOwnProperty(o)&&(e=e.replace(i,t.object[o]))})),e},this.onViewStateChange=({viewState:t})=>{this.setState({viewState:t})}}static getDerivedStateFromProps(t,e){const i=$.getDeckObject(t);if(!a()(i.initialViewState,e.initialViewState)){const t=Object.keys(i.initialViewState).reduce(((t,o)=>i.initialViewState[o]===e.initialViewState[o]?t:{...t,[o]:i.initialViewState[o]}),{});return{viewState:{...e.viewState,...t},initialViewState:i.initialViewState}}return null}render(){const t=$.getDeckObject(this.props),{viewState:e}=this.state;return(0,Z.jsx)(P,{className:"stDeckGlJsonChart",width:t.initialViewState.width,height:t.initialViewState.height,children:(0,Z.jsxs)(n.Z,{viewState:e,onViewStateChange:this.onViewStateChange,height:t.initialViewState.height,width:t.initialViewState.width,layers:this.state.initialized?t.layers:[],getTooltip:this.createTooltip,ContextProvider:r.X$.Provider,controller:!0,children:[(0,Z.jsx)(r.Z3,{height:t.initialViewState.height,width:t.initialViewState.width,mapStyle:t.mapStyle&&("string"===typeof t.mapStyle?t.mapStyle:t.mapStyle[0]),mapboxApiAccessToken:this.props.mapboxToken}),(0,Z.jsx)(I,{children:(0,Z.jsx)(r.Pv,{className:"zoomButton",showCompass:!1})})]})})}}$.getDeckObject=t=>{const{element:e,width:i,height:o,theme:n}=t,s=JSON.parse(e.json);if(!(0,L.bb)(s.mapStyle)){const t=(0,c.Iy)(n)?"light":"dark";s.mapStyle=`mapbox://styles/mapbox/${t}-v9`}return o?(s.initialViewState.height=o,s.initialViewState.width=i):(s.initialViewState.height||(s.initialViewState.height=500),e.useContainerWidth&&(s.initialViewState.width=i)),delete s.views,D.convert(s)};const _=(0,h.b)(F("st.pydeck_chart")((0,b.Z)($)))},37398:()=>{},85248:()=>{}}]);