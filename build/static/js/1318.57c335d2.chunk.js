"use strict";(globalThis.webpackChunk_stlite_desktop=globalThis.webpackChunk_stlite_desktop||[]).push([[1318],{61318:(e,t,i)=>{i.r(t),i.d(t,{default:()=>k});var s=i(5057),o=i(65873),a=i(55790),n=i(31476),r=i(59500),l=i(98209),d=i(98927),h=i(46434),m=i(9187),u=i.n(m),p=i(18950),c=i(4337),g=i(89401),b=i(45490),f=i(59990);const T=(0,b.Z)("div",{target:"ektn3o3"})((({disabled:e,theme:t})=>({alignItems:"center",backgroundColor:e?t.colors.gray:t.colors.primary,borderTopLeftRadius:"100%",borderTopRightRadius:"100%",borderBottomLeftRadius:"100%",borderBottomRightRadius:"100%",borderTopStyle:"none",borderBottomStyle:"none",borderRightStyle:"none",borderLeftStyle:"none",boxShadow:"none",display:"flex",height:t.radii.xl,justifyContent:"center",width:t.radii.xl,":focus":{outline:"none"},":focus-visible":{boxShadow:`0 0 0 0.2rem ${(0,f.DZ)(t.colors.primary,.5)}`}})),""),y=(0,b.Z)("div",{target:"ektn3o2"})((({disabled:e,theme:t})=>({fontFamily:t.genericFonts.codeFont,fontSize:t.fontSizes.sm,paddingBottom:t.spacing.twoThirdsSmFont,color:e?t.colors.gray:t.colors.primary,top:"-22px",position:"absolute",whiteSpace:"nowrap",backgroundColor:t.colors.transparent,lineHeight:t.lineHeights.base,fontWeight:"normal"})),""),R=(0,b.Z)("div",{target:"ektn3o1"})((({theme:e})=>({paddingBottom:e.spacing.none,paddingLeft:e.spacing.none,paddingRight:e.spacing.none,paddingTop:e.spacing.twoThirdsSmFont,justifyContent:"space-between",alignItems:"center",display:"flex"})),""),v=(0,b.Z)("div",{target:"ektn3o0"})((({disabled:e,theme:t})=>({lineHeight:t.lineHeights.base,fontWeight:"normal",fontSize:t.fontSizes.sm,fontFamily:t.genericFonts.codeFont,color:e?t.colors.fadedText40:"inherit"})),"");var V=i(96266);class x extends s.PureComponent{constructor(e){super(e),this.formClearHelper=new l.Kz,this.state=void 0,this.sliderRef=s.createRef(),this.thumbRef=[],this.thumbValueRef=[],this.commitWidgetValueDebounced=void 0,this.commitWidgetValue=e=>{this.props.widgetMgr.setDoubleArrayValue(this.props.element,this.state.value,e)},this.onFormCleared=()=>{this.setState(((e,t)=>({value:t.element.default})),(()=>this.commitWidgetValue({fromUi:!0})))},this.handleChange=({value:e})=>{this.setState({value:e},(()=>this.commitWidgetValueDebounced({fromUi:!0})))},this.renderThumb=s.forwardRef(((e,t)=>{const{$value:i,$thumbIndex:a}=e,n=a||0;this.thumbRef[n]=t,this.thumbValueRef[n]||=s.createRef();const r=i?this.formatValue(i[a]):"",l=(0,o.pick)(e,["role","style","aria-valuemax","aria-valuemin","aria-valuenow","tabIndex","onKeyUp","onKeyDown","onMouseEnter","onMouseLeave","draggable"]),d={};return(this.props.element.options.length>0||this.isDateTimeType())&&(d["aria-valuetext"]=r),this.thumbValueAlignment(this.thumbRef[n].current,this.thumbValueRef[n].current),(0,V.jsx)(T,{...l,disabled:!0===e.$disabled,ref:this.thumbRef[n],"aria-valuetext":r,"aria-label":this.props.element.label,children:(0,V.jsx)(y,{className:"StyledThumbValue","data-testid":"stThumbValue",disabled:!0===e.$disabled,ref:this.thumbValueRef[n],children:r})})})),this.renderTickBar=()=>{const{disabled:e,element:t}=this.props,{max:i,min:s}=t;return(0,V.jsxs)(R,{"data-testid":"stTickBar",children:[(0,V.jsx)(v,{disabled:e,"data-testid":"stTickBarMin",children:this.formatValue(s)}),(0,V.jsx)(v,{disabled:e,"data-testid":"stTickBarMax",children:this.formatValue(i)})]})},this.commitWidgetValueDebounced=(0,h.Ds)(200,this.commitWidgetValue.bind(this)),this.state={value:this.initialValue}}get initialValue(){const e=this.props.widgetMgr.getDoubleArrayValue(this.props.element);return void 0!==e?e:this.props.element.default}componentDidMount(){for(let e=0;e<Math.min(this.thumbRef.length,this.thumbValueRef.length);e++)this.thumbValueAlignment(this.thumbRef[e].current,this.thumbValueRef[e].current);this.props.element.setValue?this.updateFromProtobuf():this.commitWidgetValue({fromUi:!1})}componentDidUpdate(){this.maybeUpdateFromProtobuf()}componentWillUnmount(){this.formClearHelper.disconnect()}maybeUpdateFromProtobuf(){const{setValue:e}=this.props.element;e&&this.updateFromProtobuf()}updateFromProtobuf(){const{value:e}=this.props.element;this.props.element.setValue=!1,this.setState({value:e},(()=>{this.commitWidgetValue({fromUi:!1})}))}get value(){const{min:e,max:t}=this.props.element,{value:i}=this.state;let s=i[0],o=i.length>1?i[1]:i[0];return s>o&&(s=o),s<e&&(s=e),s>t&&(s=t),o<e&&(o=e),o>t&&(o=t),i.length>1?[s,o]:[s]}isDateTimeType(){const{dataType:e}=this.props.element;return e===d.iR.DataType.DATETIME||e===d.iR.DataType.DATE||e===d.iR.DataType.TIME}formatValue(e){const{format:t,options:i}=this.props.element;return this.isDateTimeType()?u().utc(e/1e3).format(t):i.length>0?(0,r.sprintf)(t,i[e]):(0,r.sprintf)(t,e)}thumbValueAlignment(e,t){const i=this.sliderRef.current;if(i&&e&&t){const s=i.getBoundingClientRect(),o=e.getBoundingClientRect(),a=t.getBoundingClientRect(),n=o.left+o.width/2,r=n-a.width/2<s.left,l=n+a.width/2>s.right;t.style.left=r?"0":"",t.style.right=l?"0":""}}render(){var e;const{disabled:t,element:i,theme:s,width:o,widgetMgr:n}=this.props,{colors:r,fonts:l,fontSizes:d,spacing:m}=s,u={width:o};return this.formClearHelper.manageFormClearListener(n,i.formId,this.onFormCleared),(0,V.jsxs)("div",{ref:this.sliderRef,className:"stSlider",style:u,children:[(0,V.jsx)(p.ON,{label:i.label,disabled:t,labelVisibility:(0,h.iF)(null===(e=i.labelVisibility)||void 0===e?void 0:e.value),children:i.help&&(0,V.jsx)(p.dT,{children:(0,V.jsx)(c.ZP,{content:i.help,placement:g.ug.TOP_RIGHT})})}),(0,V.jsx)(a.Z,{min:i.min,max:i.max,step:i.step,value:this.value,onChange:this.handleChange,disabled:t,overrides:{Root:{style:{paddingTop:m.twoThirdsSmFont}},Thumb:this.renderThumb,Tick:{style:{fontFamily:l.monospace,fontSize:d.sm}},Track:{style:{backgroundColor:"none !important",paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:m.twoThirdsSmFont}},InnerTrack:{style:({$disabled:e})=>({height:"4px",...e?{background:r.darkenedBgMix25}:{}})},TickBar:this.renderTickBar}})]})}}const k=(0,n.b)(x)}}]);